(()=>{"use strict";var e,t={716:function(e,t,a){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(a(294)),r=s(a(14)),o=s(a(739)),i=s(a(575)),l=(e="Unknown System")=>`Chrome Terminal [Ver 1.0] on [${e}].\nAll rights reserved.`;class c extends n.default.Component{constructor(e){var t;super(e),this.state={caretTxt:"",devConsole:"-".repeat(16)+"non-production ENV, showing console:",commandHistory:[],commandHistoryMaxLength:100,currentURL:"",stdout:null!==(t=this.props.stdoutText)&&void 0!==t?t:l(),commandHistoryIndex:-1,isDev:Boolean(!1),commandInputFocused:!1,OSName:"Unknown System"},this.commandInput=n.default.createRef(),this.cmdExecutor=new i.default({setState:e=>{this.setState(e)},currentURL:this.state.currentURL}),this.echo=this.cmdExecutor.echo}componentDidMount(){chrome.runtime.getPlatformInfo((e=>{var t;t="win"==e.os?"Windows":e.os,this.setState({OSName:t})})),chrome.tabs.query({active:!0,currentWindow:!0},(e=>{var t;this.setState({currentURL:null!==(t=e[0].url)&&void 0!==t?t:"URL unavailable"})})),chrome.storage.sync.get(["commandHistory","commandHistoryMaxLength"],(({commandHistory:e=[],commandHistoryMaxLength:t=100})=>{this.setState((a=>({commandHistory:a.commandHistory.concat(e),commandHistoryMaxLength:t})))}))}componentDidUpdate(e,t){this.state.OSName!=t.OSName&&(this.props.stdoutText||this.setState({stdout:l(this.state.OSName)}))}consPush(e){this.setState((({devConsole:t})=>({devConsole:`${t}\n${t.split("\n").length+1}\t: ${e}`})))}focusCommandInput(){this.commandInput.current.focus()}handleCmdClick(e){e.target.focus(),e.preventDefault()}handleCmdChange(e){const t=this.commandInput.current;this.setState({caretTxt:t.value.slice(0,t.selectionStart)})}handleCmdExe(e){e.preventDefault();const t=this.commandInput.current,a=t.value;this.echo.f(`> ${a}`),t.value="",t.focus(),this.setState({caretTxt:t.value.slice(0,t.selectionStart)}),this.cmdExecutor.run(a)}handleCmdKeydown(e){const t=this.commandInput.current;let a=t.selectionStart;const s=t.value;if(a&&("ArrowLeft"==e.code&&this.setState({caretTxt:s.slice(0,a-1)}),"ArrowRight"==e.code&&this.setState({caretTxt:s.slice(0,a+1)}),e.shiftKey&&(t.selectionStart=a+1,t.selectionEnd=a+1)),["ArrowUp","ArrowDown"].includes(e.code)){e.preventDefault();const a=this.state.commandHistoryIndex,s=this.state.commandHistory.length-1;var n;n="ArrowUp"==e.code?-1==a?s:0==a?0:a-1:-1==a||a==s?s:a+1,t.value=this.state.commandHistory[n],this.setState({commandHistoryIndex:n,caretTxt:t.value.slice(0,t.selectionStart)})}}handleCmdSelect(e){}render(){return n.default.createElement(n.default.Fragment,null,n.default.createElement(o.default,{keyName:"alt+c",onKeyDown:this.focusCommandInput.bind(this)}),n.default.createElement("div",{className:"noscrollbar",style:{whiteSpace:"pre-wrap",overflowWrap:"anywhere",width:"100%",height:"100%",overflowY:"scroll"}},n.default.createElement("div",{className:"noscrollbar",style:{display:"flex",width:"100%",height:"100%",flexDirection:"column"}},n.default.createElement(r.default,{text:this.state.stdout,onClick:e=>{var t;(null===(t=document.getSelection())||void 0===t?void 0:t.toString())||this.focusCommandInput()}}),n.default.createElement("form",{autoComplete:"off",onSubmit:this.handleCmdExe.bind(this),style:{display:"flex",justifyContent:"space-between",alignContent:"center"}},n.default.createElement("div",{id:"commandInput-total-container",style:{flexGrow:1,backgroundColor:"#000000",position:"relative"}},n.default.createElement("div",{id:"caret-layer",style:{position:"absolute",display:"flex",whiteSpace:"pre"}},"> "+this.state.caretTxt,n.default.createElement("div",{id:"caret-mover",style:{position:"relative"}},this.state.commandInputFocused&&n.default.createElement("div",{className:"caret",style:{position:"absolute",left:"3px",zIndex:1,whiteSpace:"pre"}}," "))),n.default.createElement("div",{style:{width:"100%",position:"absolute",display:"flex"}},">"," ",n.default.createElement("input",{type:"text",autoFocus:!0,ref:this.commandInput,onFocus:e=>this.setState({commandInputFocused:!0}),onBlur:e=>this.setState({commandInputFocused:!1}),onChange:e=>this.handleCmdChange(e),onKeyDown:this.handleCmdKeydown.bind(this),onMouseDown:e=>this.handleCmdClick(e),placeholder:"Command line: Use [ALT]+[C] to set focus here.",style:{width:"99%",backgroundColor:"#000000",caretColor:"transparent",flexGrow:1}}))),n.default.createElement("input",{type:"submit",value:"⏎",style:{padding:0,flexBasis:0,backgroundColor:"#eee",color:"#000"}})),n.default.createElement("div",{style:{display:"flex",alignItems:"baseline"}},n.default.createElement("div",{style:{width:"33%",flexShrink:0}},(new Date).toLocaleTimeString()),n.default.createElement("div",{style:{flexShrink:0,cursor:"pointer"},onClick:()=>{this.state.currentURL?(navigator.clipboard.writeText(this.state.currentURL),this.echo.f("Current URL copied.")):this.echo.f("[Error]: No current URL found.")}},"COPY URL:"),n.default.createElement("div",{style:{font:"12px sans-serif",overflow:"hidden",height:"32px",overflowWrap:"anywhere",alignSelf:"flex-start"}},this.state.currentURL))),n.default.createElement("div",{style:{font:"12px sans-serif"}},this.state.isDev&&n.default.createElement(n.default.Fragment,null,n.default.createElement("button",null,"test"),n.default.createElement("div",{style:{whiteSpace:"pre-wrap"}},this.state.devConsole)))))}}t.default=c},14:function(e,t,a){var s=this&&this.__createBinding||(Object.create?function(e,t,a,s){void 0===s&&(s=a),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,s){void 0===s&&(s=a),e[s]=t[a]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&s(t,e,a);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const o=r(a(294));t.default=e=>{const t=o.useRef(null);return o.useEffect((()=>{t.current.scrollIntoView({behavior:"auto",block:"end"})}),[e.text]),o.default.createElement(o.default.Fragment,null,o.default.createElement("div",{style:{overflowY:"scroll",height:"100%",overflowWrap:"anywhere"},className:"noscrollbar",onClick:e.onClick},o.default.createElement("div",null,e.text),o.default.createElement("div",{ref:t})))}},898:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.aliasObj=void 0,t.aliasObj=class{constructor(e){this.name=e.name,this.s=e.s,this.aliasType=e.aliasType,this.comment=e.comment}}},575:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=a(593),n=a(898);class r{constructor(e){this.name=e.name,this.f=e.f,this.prebuilt=e.prebuilt,this.manShort=e.manShort,this.manFull=e.manFull}}const o=e=>{console.log("fake setState",e)};t.default=class{constructor({setState:e=o,currentURL:t="URL unavailable"}={setState:o,currentURL:"URL unavailable"}){this.aliasNameMaxLength=12,this.hasSetState=!1,this.userAliases={$URL:new n.aliasObj({name:"$URL",s:["URL unavailable"],aliasType:"prebuilt",comment:"Prebuilt environment variable. URL of current page."})},this.echo=new r({name:"echo",f:e=>{this.setState((({stdout:t})=>({stdout:`${t}\n${e}`})))},prebuilt:!0,manShort:"Show thing on screen",manFull:"ECHO [string text]"}),this.basicCmds={alias:new r({name:"alias",f:e=>{if(e){const[t,...a]=e.trim().split("="),s=a.join("=");if(s){if(this.checkAlias(s.split(" "))){const e={name:t,s:s.split(" "),aliasType:"user-defined",comment:`added on ${Date()}`};Object.assign(this.userAliases,{[t]:e});const a=Object.assign({},this.userAliases);Reflect.deleteProperty(a,"$URL"),chrome.storage.sync.set({userAliases:a}),this.echo.f(`alias ${t} for ${s} added. \nYou can edit it in option page [EXPORT]`)}}else this.echo.f(`[${t}] is an alias: ${this.userAliases[t].comment}\nalias for [${this.userAliases[t].s.join(" ")}] `)}else{const e=(e,t)=>`${e}${(t.name+" ".repeat(this.aliasNameMaxLength+4)).slice(0,this.aliasNameMaxLength+4)}${t.comment}\n`,t=Object.values(this.userAliases).reduce(e,"");this.echo.f(`All Alias:\n${t}`)}},prebuilt:!0,manShort:"Make new alias or check exsisted alias",manFull:"ALIAS [value(=value)]"}),copy:new r({name:"copy",f:e=>{this.echo.f(`copied ${e.slice(0,20)}${e.length>20?" (... omitted)":""}`),navigator.clipboard.writeText(e)},prebuilt:!0,manShort:"Make new alias or check exsisted alias",manFull:"ALIAS [name(=value)]"}),echo:this.echo,edit:new r({name:"edit",f:e=>{e||chrome.tabs.query({active:!0,currentWindow:!0},(e=>{const t=e[0];chrome.tabs.executeScript(t.id,{code:"document.designMode='on'"},(e=>{if(chrome.runtime.lastError){var t=chrome.runtime.lastError.message;console.log("errorMsg : ",t),this.echo.f(null!=t?t:""),chrome.permissions.request({permissions:["tabs"],origins:[this.userAliases.$URL.s[0]]},(e=>{e?(this.echo.f("Permission granted."),this.basicCmds.edit.f()):console.log("Permission denied. You cannot use this command.")}))}else"on"==e[0]&&this.echo.f("You can edit current page now.")}))}))},prebuilt:!0,manShort:"Show manual",manFull:"MAN [command name]\n        \n        Has alias: help\n        For more help, use OPTION HELP"}),man:new r({name:"man",f:e=>{var t,a,s;if(e){const n=null!==(s=null===(a=null!==(t=this.basicCmds[e])&&void 0!==t?t:this.userAliases[e])||void 0===a?void 0:a.manFull)&&void 0!==s?s:"no such function";this.echo.f(`${" ".repeat(15)}MANUAL - ${e}:\n${n}`)}else{const e=Object.keys(this.basicCmds).join("\t"),t=Object.keys(this.userAliases).join("\t");this.echo.f(`Commands:\necho\t${e}\nAliases:\n${t}`)}},prebuilt:!0,manShort:"Show manual",manFull:"MAN [command name]\n        \n        Has alias: help\n        For more help, use OPTION HELP"}),open:new r({name:"open",f:e=>{e?chrome.tabs.query({active:!1,url:e,windowId:-2},(t=>{t.length?(chrome.tabs.highlight({tabs:t.map((e=>e.index))}),chrome.tabs.getCurrent((e=>{chrome.tabs.remove(e.id,(function(){}))}))):chrome.tabs.create({url:e})})):this.echo.f("ERROR: needs an URL.")},prebuilt:!0,manShort:"OPEN [URL] : Open an URL",manFull:"OPEN [URL]"})},e!=o&&(this.hasSetState=!0),this.commandHistoryMaxLength=100,chrome.storage.sync.get(["aliasNameMaxLength","userAliases","commandHistoryMaxLength"],(({aliasNameMaxLength:e=12,userAliases:t={},commandHistoryMaxLength:a=100})=>{this.aliasNameMaxLength=e,Object.assign(this.userAliases,t),this.commandHistoryMaxLength=a})),this.setState=e,chrome.tabs.query({active:!0,currentWindow:!0},(e=>{var a;this.userAliases.$URL.s[0]=null!==(a=e[0].url)&&void 0!==a?a:t}))}checkAlias(e){const t="Error in parseAlias: Max alias depth exceeded",a=this.parseAlias(e,256);if(("string"==typeof a||a instanceof String)&&a.startsWith(t))return this.echo.f("WARNING: Alias has more than 256 levels of referece, please check for circular reference."),!1;const s=this.parseAlias(e,64);return!("string"==typeof s||s instanceof String)||!s.startsWith(t)||(this.echo.f("WARNING: Alias has more than 64 levels of referece, please consider flatten the alias."),!1)}parseAlias(e,t=256){let a=0;for(;a<t;){let t=e.flatMap((e=>{var t,a;return null!==(a=null===(t=this.userAliases[e])||void 0===t?void 0:t.s)&&void 0!==a?a:e}));if(s.arrayEqual(e,t))return{parsed:t,status:0==a?"UNCHANGED":"PARSED"};e=t,a+=1}return{parsed:[`Error in parseAlias: Max alias depth exceeded :(${t}) times`],status:"ERROR"}}formatCmdTxt(e){if(""==e.trim())return;const t=e.split(" "),[a,...s]="alias"==t[0]?[t[0],t.slice(1).join(" ")]:this.parseAlias(t).parsed;return{command:a,params:s,status:this.parseAlias(t).status}}updateHistory(e){chrome.storage.sync.get("commandHistory",(({commandHistory:t})=>{const a=t.concat([e]).slice(-this.commandHistoryMaxLength);chrome.storage.sync.set({commandHistory:a}),this.setState({commandHistory:a,commandHistoryIndex:-1}),console.log("newHist : ",a)}))}run(e){if(null==this.formatCmdTxt(e))return;this.updateHistory(e);const{command:t,params:a}=this.formatCmdTxt(e);t in this.basicCmds?this.basicCmds[t].f(...a):this.echo.f(`${e} is not a command`)}}},593:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.arrayUnique=t.arrayEqual=void 0,t.arrayEqual=function(e,t){return e.length==t.length&&!e.find(((e,a)=>e!=t[a]))},t.arrayUnique=function(e){return[...new Set(e)]}},548:function(e,t,a){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=s(a(294)),r=s(a(935)),o=s(a(716));r.default.render(n.default.createElement(n.default.StrictMode,null,n.default.createElement((()=>n.default.createElement(n.default.Fragment,null,n.default.createElement("div",{style:{width:"640px",height:"480px"}},n.default.createElement(o.default,null)))),null)),document.getElementById("root"))}},a={};function s(e){var n=a[e];if(void 0!==n)return n.exports;var r=a[e]={exports:{}};return t[e].call(r.exports,r,r.exports,s),r.exports}s.m=t,e=[],s.O=(t,a,n,r)=>{if(!a){var o=1/0;for(u=0;u<e.length;u++){for(var[a,n,r]=e[u],i=!0,l=0;l<a.length;l++)(!1&r||o>=r)&&Object.keys(s.O).every((e=>s.O[e](a[l])))?a.splice(l--,1):(i=!1,r<o&&(o=r));if(i){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[a,n,r]},s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.j=42,(()=>{var e={42:0};s.O.j=t=>0===e[t];var t=(t,a)=>{var n,r,[o,i,l]=a,c=0;for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(l)var u=l(s);for(t&&t(a);c<o.length;c++)r=o[c],s.o(e,r)&&e[r]&&e[r][0](),e[o[c]]=0;return s.O(u)},a=self.webpackChunkchrome_terminal=self.webpackChunkchrome_terminal||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var n=s.O(void 0,[736],(()=>s(548)));n=s.O(n)})();